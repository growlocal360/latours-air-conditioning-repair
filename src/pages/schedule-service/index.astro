---
import BaseLayout from '../../layouts/BaseLayout.astro';
---

<BaseLayout
  title="Schedule Service | Latour's HVAC - Lake Charles, LA"
  description="Schedule HVAC service with Latour's in Lake Charles, LA. Book AC repair, heating service, maintenance, or free installation estimates online. Call (337) 912-1233."
  keywords="schedule hvac service, book ac repair, schedule heating service, hvac appointment lake charles"
  ogTitle="Schedule Service | Latour's HVAC - Lake Charles, LA"
  ogDescription="Book your HVAC service appointment online. AC repair, heating service, and free installation estimates."
  canonicalUrl="https://latourshvac.com/schedule-service/"
>
  <!-- Page Header -->
  <section class="page-header">
    <div class="container">
      <h1>Schedule HVAC Service</h1>
      <p>Book your appointment online for AC repair, heating service, maintenance, or a free installation estimate.</p>
    </div>
  </section>

  <!-- Schedule Form Content -->
  <section class="content-section">
    <div class="container">
      <div class="content-grid">
        <div class="content-main">
          <div style="background: #fff3cd; border: 1px solid #ffc107; padding: 1rem 1.5rem; border-radius: var(--radius-md); margin-bottom: 2rem; display: flex; align-items: center; gap: 1rem;">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#856404" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <div>
              <strong style="color: #856404;">Need Emergency Service?</strong>
              <span style="color: #856404;">For urgent AC or heating issues, call us directly at <a href="tel:+13379121233" style="color: #856404; font-weight: 600;">(337) 912-1233</a> for fastest response.</span>
            </div>
          </div>

          <h2>Request an Appointment</h2>
          <p>Fill out the form below and we'll contact you within 2 hours during business hours to confirm your appointment.</p>

          <form id="schedule-form" method="POST" data-validate style="margin-top: 1.5rem; background: var(--off-white); padding: 2rem; border-radius: var(--radius-lg);">
            <h3 style="margin-bottom: 1rem; color: var(--primary-blue-dark);">Contact Information</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <div class="form-group">
                <label for="first-name">First Name *</label>
                <input type="text" id="first-name" name="first_name" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="last-name">Last Name *</label>
                <input type="text" id="last-name" name="last_name" class="form-control" required>
              </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <div class="form-group">
                <label for="phone">Phone Number *</label>
                <input type="tel" id="phone" name="phone" class="form-control" required placeholder="(337) 555-1234">
              </div>
              <div class="form-group">
                <label for="email">Email Address *</label>
                <input type="email" id="email" name="email" class="form-control" required placeholder="you@example.com">
              </div>
            </div>

            <h3 style="margin: 1.5rem 0 1rem; color: var(--primary-blue-dark);">Service Location</h3>
            <div class="form-group">
              <label for="address">Street Address *</label>
              <input type="text" id="address" name="address" class="form-control" required placeholder="123 Main Street">
            </div>
            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 1rem;">
              <div class="form-group">
                <label for="city">City *</label>
                <input type="text" id="city" name="city" class="form-control" required value="Lake Charles">
              </div>
              <div class="form-group">
                <label for="state">State</label>
                <input type="text" id="state" name="state" class="form-control" value="LA" readonly>
              </div>
              <div class="form-group">
                <label for="zip">ZIP Code *</label>
                <input type="text" id="zip" name="zip" class="form-control" required placeholder="70601">
              </div>
            </div>

            <h3 style="margin: 1.5rem 0 1rem; color: var(--primary-blue-dark);">Service Details</h3>
            <div class="form-group">
              <label for="service-type">Type of Service *</label>
              <select id="service-type" name="service_type" class="form-control" required>
                <option value="">Select service type...</option>
                <optgroup label="Air Conditioning">
                  <option value="ac-repair">AC Repair</option>
                  <option value="ac-installation">AC Installation / Replacement</option>
                  <option value="ac-tune-up">AC Tune-Up / Maintenance</option>
                  <option value="ac-emergency">Emergency AC Repair</option>
                </optgroup>
                <optgroup label="Heating">
                  <option value="furnace-repair">Furnace Repair</option>
                  <option value="furnace-installation">Furnace Installation</option>
                  <option value="heat-pump-repair">Heat Pump Repair</option>
                  <option value="heat-pump-installation">Heat Pump Installation</option>
                  <option value="heating-tune-up">Heating Tune-Up</option>
                </optgroup>
                <optgroup label="Other Services">
                  <option value="maintenance-plan">Maintenance Plan</option>
                  <option value="indoor-air-quality">Indoor Air Quality</option>
                  <option value="duct-cleaning">Duct Cleaning</option>
                  <option value="thermostat">Thermostat Installation</option>
                  <option value="other">Other</option>
                </optgroup>
              </select>
            </div>

            <div class="form-group">
              <label for="urgency">How Urgent Is This?</label>
              <select id="urgency" name="urgency" class="form-control">
                <option value="routine">Routine - Schedule at convenience</option>
                <option value="soon">Soon - Within the next few days</option>
                <option value="urgent">Urgent - System not working properly</option>
                <option value="emergency">Emergency - Call me ASAP</option>
              </select>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <div class="form-group">
                <label for="preferred-date">Preferred Date</label>
                <input type="date" id="preferred-date" name="preferred_date" class="form-control">
              </div>
              <div class="form-group">
                <label for="preferred-time">Preferred Time</label>
                <select id="preferred-time" name="preferred_time" class="form-control">
                  <option value="morning">Morning (8am - 12pm)</option>
                  <option value="afternoon">Afternoon (12pm - 5pm)</option>
                  <option value="flexible">Flexible - Any time</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label for="equipment-info">Equipment Information (optional)</label>
              <input type="text" id="equipment-info" name="equipment_info" class="form-control" placeholder="Brand, model, age of system if known">
            </div>

            <div class="form-group">
              <label for="problem-description">Describe the Problem or Request *</label>
              <textarea id="problem-description" name="problem_description" class="form-control" rows="4" required placeholder="Please describe what's happening with your HVAC system, or what service you need..."></textarea>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: flex-start; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" name="consent" required style="margin-top: 4px;">
                <span style="font-size: 0.9rem;">I consent to being contacted by Latour's HVAC regarding my service request via phone, email, or text message.</span>
              </label>
            </div>

            <button type="submit" class="btn btn-primary btn-lg btn-block">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
              Request Appointment
            </button>
          </form>

          <!-- Success Message (hidden by default) -->
          <div id="form-success" style="display: none; background: #d4edda; border: 1px solid #28a745; padding: 2rem; border-radius: var(--radius-lg); text-align: center; margin-top: 1.5rem;">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#28a745" stroke-width="2" style="margin-bottom: 1rem;"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
            <h3 style="color: #155724; margin-bottom: 0.5rem;">Request Submitted Successfully!</h3>
            <p style="color: #155724;">Thank you! We'll contact you within 2 hours during business hours to confirm your appointment.</p>
          </div>

          <!-- Error Message (hidden by default) -->
          <div id="form-error" style="display: none; background: #f8d7da; border: 1px solid #dc3545; padding: 1.5rem; border-radius: var(--radius-lg); text-align: center; margin-top: 1rem;">
            <p style="color: #721c24; margin: 0;">There was an error submitting your request. Please call us at <a href="tel:+13379121233" style="color: #721c24; font-weight: 600;">(337) 912-1233</a> to schedule your appointment.</p>
          </div>

          <div style="margin-top: 2rem; text-align: center; padding: 1.5rem; border: 2px dashed var(--light-gray); border-radius: var(--radius-lg);">
            <h3 style="margin-bottom: 0.5rem;">Prefer to Talk to Someone?</h3>
            <p style="margin-bottom: 1rem;">Call us directly and we'll schedule your appointment over the phone.</p>
            <a href="tel:+13379121233" class="btn btn-secondary btn-lg">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
              Call (337) 912-1233
            </a>
          </div>
        </div>

        <!-- Sidebar -->
        <aside class="sidebar">
          <div class="sidebar-widget sidebar-cta">
            <h4>Emergency? Call Now</h4>
            <p>For urgent AC or heating emergencies, skip the form and call us directly.</p>
            <div class="phone">
              <a href="tel:+13379121233">(337) 912-1233</a>
            </div>
            <p style="font-size: 0.875rem; opacity: 0.9; margin-top: 0.5rem;">Available 24/7</p>
          </div>

          <div class="sidebar-widget">
            <h4>What to Expect</h4>
            <ul style="padding-left: 0;">
              <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--light-gray);">
                <strong>1. Submit Request</strong><br>
                <span style="font-size: 0.875rem; color: var(--medium-gray);">Fill out the form with your details</span>
              </li>
              <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--light-gray);">
                <strong>2. Confirmation Call</strong><br>
                <span style="font-size: 0.875rem; color: var(--medium-gray);">We'll call within 2 hours to confirm</span>
              </li>
              <li style="padding: 0.5rem 0; border-bottom: 1px solid var(--light-gray);">
                <strong>3. Technician Visit</strong><br>
                <span style="font-size: 0.875rem; color: var(--medium-gray);">Our tech arrives at scheduled time</span>
              </li>
              <li style="padding: 0.5rem 0;">
                <strong>4. Problem Solved</strong><br>
                <span style="font-size: 0.875rem; color: var(--medium-gray);">We fix it right the first time</span>
              </li>
            </ul>
          </div>

          <div class="sidebar-widget">
            <h4>Our Services</h4>
            <ul>
              <li><a href="/ac-contractor/">AC Contractor</a></li>
              <li><a href="/furnace-repair/">Furnace Repair</a></li>
              <li><a href="/heating-contractor/">Heating Contractor</a></li>
              <li><a href="/hvac-contractor/">HVAC Services</a></li>
            </ul>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('schedule-form');
      const successDiv = document.getElementById('form-success');
      const errorDiv = document.getElementById('form-error');

      if (form) {
        form.addEventListener('submit', async function(e) {
          e.preventDefault();

          // Reset messages
          successDiv.style.display = 'none';
          errorDiv.style.display = 'none';

          // Get form data
          const formData = new FormData(form);

          // Build URL-encoded payload for GHL webhook (works better with no-cors)
          const payload = new URLSearchParams();
          payload.append('first_name', formData.get('first_name') || '');
          payload.append('last_name', formData.get('last_name') || '');
          payload.append('name', `${formData.get('first_name') || ''} ${formData.get('last_name') || ''}`.trim());
          payload.append('phone', formData.get('phone') || '');
          payload.append('email', formData.get('email') || '');
          payload.append('address1', formData.get('address') || '');
          payload.append('city', formData.get('city') || '');
          payload.append('state', formData.get('state') || '');
          payload.append('postal_code', formData.get('zip') || '');
          payload.append('service_type', formData.get('service_type') || '');
          payload.append('urgency', formData.get('urgency') || '');
          payload.append('preferred_date', formData.get('preferred_date') || '');
          payload.append('preferred_time', formData.get('preferred_time') || '');
          payload.append('equipment_info', formData.get('equipment_info') || '');
          payload.append('message', formData.get('problem_description') || '');
          payload.append('source', 'Website Contact Form');
          payload.append('tags', 'Website Lead,Schedule Service');

          // Disable submit button
          const submitBtn = form.querySelector('button[type="submit"]');
          const originalBtnText = submitBtn.innerHTML;
          submitBtn.disabled = true;
          submitBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="animation: spin 1s linear infinite;"><path d="M21 12a9 9 0 1 1-6.219-8.56"></path></svg> Submitting...';

          try {
            // Use form-urlencoded which works with no-cors mode
            await fetch('https://services.leadconnectorhq.com/hooks/R611puAaZDQp12dpdWA3/webhook-trigger/82b2a49e-1216-40c5-aa3c-35672eeb15a6', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
              },
              body: payload.toString(),
              mode: 'no-cors'
            });

            // Show success (with no-cors we can't verify response, but request was sent)
            form.style.display = 'none';
            successDiv.style.display = 'block';
            successDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

            // Track conversion if Google Analytics is available
            if (typeof gtag !== 'undefined') {
              gtag('event', 'form_submission', {
                'event_category': 'Contact',
                'event_label': 'Schedule Service Form'
              });
            }

          } catch (error) {
            console.error('Form submission error:', error);
            errorDiv.style.display = 'block';
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalBtnText;
          }
        });
      }
    });
  </script>

  <style>
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
  </style>
</BaseLayout>
